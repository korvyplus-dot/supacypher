import tkinter as tk;from tkinter import messagebox;import lzma;import numpy as np;C_P=[tuple([a,b,c])for a in range(0,256,85) for b in range(0,256,85) for c in range(0,256,85)]
class EA:
    def __init__(self, m):self.m=m;m.title("ec");self.ti=tk.Text(m,wrap=tk.WORD,width=80,height=10);self.ti.pack(pady=10);self.eb=tk.Button(m,text="",command=self.ed);self.eb.pack(pady=5);self.il = tk.Label(m);self.il.pack(pady=10);self.t_i = None
    def ed(self):(it:=self.ti.get(1.0,tk.END).strip())and(eb:=it.encode('cp1251'),cb:=lzma.compress(eb),bs:=''.join(bin(bv)[2:].zfill(8)for bv in cb))or(messagebox.showwarning("")if not it else None);sbc=[];sbc+=[int(f"{bs[i:i+6]:0<6}", 2) for i in range(0,len(bs),6)];pw=1200;ph=600;bs=4;lw=pw//bs;lh=ph//bs;tlp=lw*lh;(len(sbc) < tlp and len(sbc) < tlp) and exec(f"pn={tlp}-len(sbc);odo=list(sbc);odl=len(odo);sbc.extend([63]*4+[odo[i%odl]for i in range(pn-4)]if odl>0 and pn>=4 else [63]*pn if odl==0 else [63]*min(4,pn))") or (len(sbc) > tlp and exec("sbc=sbc[:tlp]") or None);b_s=20;b_c6bv=48;b_c=C_P[b_c6bv];b_pw=pw+2*b_s;b_ph=ph+2*b_s;b_rpa=[[b_c for _ in range(b_pw)] for _ in range(b_ph)];[[[b_rpa[i*bs+b_s+by].__setitem__(j*bs+bx+b_s,C_P[sbc[i*lw+j]])for bx in range(bs)] for by in range(bs)]for i in range(lh) for j in range(lw)];rg_po=b_rpa;self.img_array=np.array(rg_po,dtype=np.uint8);npa=self.img_array;height,width,_=npa.shape;hr=f'P6\n{width} {height}\n255\n'.encode('ascii');da=npa.tobytes();self.tk_image=tk.PhotoImage(width=width,height=height,da=hr+da,format='PPM');self.il.config(image=self.tk_image)
if __name__=="__main__":r=tk.Tk();app=EA(r);r.mainloop()